[gd_scene load_steps=38 format=4 uid="uid://cjqln2kqwkwc4"]

[ext_resource type="Script" path="res://addons/pl-state-machine/classes/PLStateMachine.gd" id="1_c7j07"]
[ext_resource type="PackedScene" uid="uid://srhpt5107l1u" path="res://scenes/Map.tscn" id="2_2bc4d"]
[ext_resource type="Script" path="res://addons/pl-state-machine/classes/PLState.gd" id="2_jjydy"]
[ext_resource type="Script" path="res://scripts/state/SimpleTransition.gd" id="3_cdlvk"]
[ext_resource type="Script" path="res://scripts/signalrelay.gd" id="3_flvjl"]
[ext_resource type="Script" path="res://scripts/play_named_animation.gd" id="3_utl4f"]
[ext_resource type="Script" path="res://scripts/state/TransitionAfter.gd" id="4_00bpe"]
[ext_resource type="Script" path="res://scripts/tower_placement/TowerPlacementCursor.gd" id="5_ffcvi"]
[ext_resource type="Script" path="res://scripts/Exit.gd" id="6_1nd5i"]
[ext_resource type="Material" uid="uid://chj0byxde1hmk" path="res://assets/materials/indicator_invalid.tres" id="7_813af"]
[ext_resource type="Script" path="res://scripts/Pause-Resume.gd" id="7_m0nf8"]
[ext_resource type="Material" uid="uid://jdrp6rhfkskx" path="res://assets/materials/indicator_valid.tres" id="7_nbnsr"]
[ext_resource type="PackedScene" uid="uid://c28v1lcjn3ks4" path="res://prefabs/spawner.tscn" id="8_ips6i"]
[ext_resource type="PackedScene" uid="uid://c6nunh56tvqt7" path="res://prefabs/enemies/enemy_1.tscn" id="9_jyc2j"]
[ext_resource type="PackedScene" uid="uid://ct1s71qnccv36" path="res://prefabs/enemies/enemy_2.tscn" id="10_bt8ur"]
[ext_resource type="PackedScene" uid="uid://bdcit6wslybiv" path="res://prefabs/enemies/enemy_indy.tscn" id="11_g30fw"]
[ext_resource type="PackedScene" uid="uid://dbxn1et2iualn" path="res://prefabs/enemies/enemy_croc.tscn" id="11_o3g5j"]
[ext_resource type="PackedScene" uid="uid://cht5gqlgvhwmc" path="res://scenes/pyramid.tscn" id="13_tao2x"]
[ext_resource type="PackedScene" uid="uid://6838mpvlhuxx" path="res://prefabs/enemies/enemy_roman.tscn" id="13_yqiol"]
[ext_resource type="Texture2D" uid="uid://dtoiitdxafky8" path="res://art_assets/ui/button_square_Ucupaint Material.png" id="17_awbgd"]
[ext_resource type="Script" path="res://scripts/ui/HealthDisplay.gd" id="17_qjf4m"]
[ext_resource type="FontFile" uid="uid://kuabpcxa6ck4" path="res://assets/fonts/Zatanna Misdirection.otf" id="18_odmy1"]
[ext_resource type="Script" path="res://scripts/ui/DiegeticButton.gd" id="19_d2pne"]
[ext_resource type="Script" path="res://scripts/ui/ScoreDisplay.gd" id="19_dibw2"]
[ext_resource type="PackedScene" uid="uid://bmrysnx04toau" path="res://art_assets/ui/button_square.glb" id="19_iw33e"]
[ext_resource type="Script" path="res://scripts/tower_placement/TowerPlacementSelect.gd" id="21_l56ot"]
[ext_resource type="Resource" path="res://prefabs/towers/spiketrap_tower_data.tres" id="23_a7ts0"]
[ext_resource type="Resource" path="res://prefabs/towers/crossbow_tower_data.tres" id="24_njx8m"]

[sub_resource type="BoxMesh" id="BoxMesh_ad2qx"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_b7qny"]
resource_name = "Material.001"
cull_mode = 2
albedo_texture = ExtResource("17_awbgd")
roughness = 0.5

[sub_resource type="ArrayMesh" id="ArrayMesh_l6yq8"]
_surfaces = [{
"aabb": AABB(-1.42304, -0.545597, -1.34314, 2.84608, 0.961107, 2.68628),
"format": 34896613377,
"index_count": 90,
"index_data": PackedByteArray("CwACAA0ACwAAAAIAEAAOABIAEAAKAA4AEQADAAcAEQAMAAMABgATAAgABgAPABMAAgAEAAMABwAJAAgADAAOAA0AEQATABIAAAAEAAIAAAABAAQAAwAJAAcAAwAEAAkACAAFAAYACAAJAAUABwATABEABwAIABMAEgAPABAAEgATAA8AEQAOAAwAEQASAA4ADQAKAAsADQAOAAoADAACAAMADAANAAIAAQAJAAQAAQAFAAkA"),
"lods": [0.088196, PackedByteArray("CwACAAwACwAAAAIADAAKAAsADAAOAAoAEAAOABMAEAAKAA4AEwAPABAABgAPABMABgATAAgAEwADAAcAAwAEAAcAEwAMAAMAEwAOAAwABwAIABMAAgAEAAMAAAAEAAIAAAABAAQACAAFAAYACAAHAAUAAQAFAAcAAQAHAAQADAACAAMA")],
"name": "Material.001",
"primitive": 3,
"uv_scale": Vector4(0, 0, 0, 0),
"vertex_count": 20,
"vertex_data": PackedByteArray("/AYAAP//AAAAAAAAmPgAAPwGT+v//wAA/Ab//5j4AAAAAE/rmPgAAAAAAABmBwAA/AYAAAAAAAD8Bv//ZgcAAPwGT+sAAAAAAABP62YHAAD//wAAmPgAAAL5AAD//wAAAvn//5j4AAAC+U/r//8AAP//T+uY+AAAAvkAAAAAAAD//wAAZgcAAAL5//9mBwAA//9P62YHAAAC+U/rAAAAAA==")
}]
blend_shape_mode = 0

[sub_resource type="ArrayMesh" id="ArrayMesh_blnw8"]
resource_name = "button_square_Cube_001"
_surfaces = [{
"aabb": AABB(-1.42304, -0.545597, -1.34314, 2.84608, 0.961107, 2.68628),
"attribute_data": PackedByteArray("Q+/Ti++7Zb7YvWW+/39goqT+04uPmEvQ77ueze+7ns3pmUvQ6ZlL0OS89c7pmUvQ2L2ezdi9ns3pmfXOYI9gov9/ioP/f4qDj5j1zv9/pYH4xUvQ+MVL0LqQmIL4xUvQ8Kf1zlLHS9Bgj6WBYI+lgWCPioNgj4qD+MX1zmCPioND74Cuj5hyjUPvm6xD75us6Zmo/umZqP7//42t6Zmo/qT+m6yPmKj+pP6brKT+m6yk/oCupP6ArumZ///wp3KNj5gsro+YLK6PmEisj5hIrPjFqP74xaj+Sqk6rfjFqP7wp0is8KdIrPjF///wp0is8KcsrlLHqP7wpyyu8KcsrumZS9DYvZ7N/3+Kg/jFS9C6kJiCYI+lgUPvm6zpmaj+//+NraT+gK6PmCyuj5hIrPCnLK5Sx6j+Useo/g=="),
"format": 34896613399,
"index_count": 90,
"index_data": PackedByteArray("IgAEACgAIgAAAAQAMwAvADsAMwAhAC8ANQAJABUANQAlAAkAEgA8ABgAEgAwADwABgAMAAoAFgAcABoAJgAsACoANgA+ADgAAQANAAcAAQACAA0ACwAeABcACwAOAB4AGwAQABMAGwAdABAAFAA9ADQAFAAZAD0AOQAxADIAOQA/ADEANwAuACcANwA6AC4AKwAgACMAKwAtACAAJAAFAAgAJAApAAUAAwAfAA8AAwARAB8A"),
"lods": [0.088196, PackedByteArray("RgAEAEgARgAAAAQASAAgAEYASABJACAASwAvAEwASwAhAC8ATABKAEsAEgBKADwAEgA8ABgATQBAAEMAQAAOAEMATQBHAEAATgAuAEcAFAAZAE0ABgBBAAoAAQBBAAYAAQACAEEARQBCABMARQBEAEIAAwBCAEQAAwBEAA8AJAAFAAgA")],
"material": SubResource("StandardMaterial3D_b7qny"),
"name": "Material.001",
"primitive": 3,
"uv_scale": Vector4(1.97946, 2, 0, 0),
"vertex_count": 79,
"vertex_data": PackedByteArray("/AYAAP///7/8BgAA/////wAAAACY+P//AAAAAJj4VNX8Bk/r////v/wGT+v///zF/AZP6///h/b8Bk/r//////wG//+Y+PzF/Ab//5j4VNX8Bv//mPiH9vwG//+Y+KrpAABP65j4h/YAAE/rmPj//wAAT+uY+KrpAABP65j4VNUAAAAAZgeq6QAAAABmB1TV/AYAAAAA///8BgAAAACq6fwG//9mB6rp/Ab//2YHVNX8Bv//Zgdu2fwG//9mB6rp/AZP6wAA///8Bk/rAACq6fwGT+sAAG7Z/AZP6wAAqukAAE/rZgdu2QAAT+tmB6rpAABP62YHqukAAE/rZgdU1f//AACY+PzF//8AAJj4VNUC+QAA////vwL5AAD///zFAvn//5j4/MUC+f//mPhU1QL5//+Y+HPRAvn//5j4/MUC+U/r////vwL5T+v///zFAvlP6///c9EC+U/r///8xf//T+uY+HPR//9P65j4/MX//0/rmPj8xf//T+uY+FTVAvkAAAAA//8C+QAAAACq6f//AABmB6rp//8AAGYHVNUC+f//Zgeq6QL5//9mB1TVAvn//2YHGvsC+f//Zgf8xf//T+tmBxr7//9P62YHqun//0/rZgf8xf//T+tmB1TVAvlP6wAA//8C+U/rAACq6QL5T+sAABr7AvlP6wAAqun8Bv//mPhf2wAAT+uY+Nn8AAAAAGYHtuL8Bv//Zgdk3vwG//9mB2nK/AZP6wAAy9wC+QAA//+owAL5//+Y+FLNAvn//5j4B8///0/rmPiXzgL5AAAAALj0//8AAGYHk9sC+U/rAAAZ3wL5T+sAAJPbAvlP6wAArMj/////glr/f4Ja/39U1VTV///////i/xyC6Jweglr/f//i/xxU1aoqguicHgjqBDWC6Jweglr/fwjqBDVU1VTV+sr6ylTVVNX/v/+/+sr6yvrKBDVU1aoq+srmugjqBDX/v/+/+soENfrK5rr6yvrK+srmuvrK+soI6gQ1VNVU1f8c/xyqKqoq//////8c/xz/4v8cVNWqKs0vSwb9uf8c///////i/xzNL0sG/xz/HM0vSwb/HP8c/bn/HKoqqir/v/+/BDUENQQ1BDWqKqoq+soENVTVqioENa4o/bn/HAQ1rigENQQ1/bn/HKoqqir/v/+/+soENQQ1rigENQQ1b+7cLm33+yJOzizOUthGRR/DKdZItvDQFA0UDcLUeRYBJrIUqioMGzU6NTorLisu+C/4L/7R8T4guv8/")
}]
blend_shape_mode = 0
shadow_mesh = SubResource("ArrayMesh_l6yq8")

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_k3uw6"]
points = PackedVector3Array(-1.44563, -0.568088, -1.3201, -0.0348027, 0.401665, 1.27932, -1.32476, 0.401665, 1.27932, 0, -0.568088, 1.34456, -0.0258904, 0.407791, -1.27319, 0, -0.568088, -1.36546, -1.44563, -0.568088, 1.2992, -1.40556, 0.355323, -1.2475, -1.40556, 0.355323, 1.2266, -1.36282, 0.398066, -1.24756, -1.36767, 0.358577, -1.30011, -1.40035, -0.568088, 1.34456, -1.40035, -0.568088, -1.36546, -0.0259416, 0.36415, -1.31683)

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_18mgh"]
points = PackedVector3Array(0, -0.568088, -1.36546, 1.40556, 0.355323, 1.2266, 1.44563, -0.568088, 1.2992, 0, -0.568088, 1.34456, 0.0258904, 0.407791, -1.27319, 1.44563, -0.568088, -1.3201, 0.0348027, 0.401665, 1.27932, 1.36282, 0.398066, -1.24756, 1.32476, 0.401665, 1.27932, 1.36767, 0.358577, -1.30011, 1.40556, 0.355323, -1.2475, 1.40035, -0.568088, 1.34456, 1.40035, -0.568088, -1.36546, 0.0259416, 0.36415, -1.31683)

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_6b1ja"]

[sub_resource type="Sky" id="Sky_482bn"]
sky_material = SubResource("ProceduralSkyMaterial_6b1ja")

[sub_resource type="Environment" id="Environment_0i1up"]
background_mode = 2
sky = SubResource("Sky_482bn")

[node name="Main" type="Node3D"]

[node name="GameState" type="Node" parent="."]
unique_name_in_owner = true
process_mode = 3
script = ExtResource("1_c7j07")
active_state_key = "STATE_Menu"

[node name="STATE_Menu" type="Node" parent="GameState"]
script = ExtResource("2_jjydy")

[node name="MenuVisibility" type="Node" parent="GameState/STATE_Menu"]
script = ExtResource("3_flvjl")

[node name="GoToBegin" type="Node" parent="GameState/STATE_Menu"]
script = ExtResource("3_cdlvk")
target_state = "STATE_Begin"
wait_for_frame = true

[node name="GoToExit" type="Node" parent="GameState/STATE_Menu"]
script = ExtResource("3_cdlvk")
target_state = "STATE_Exiting"
wait_for_frame = true

[node name="STATE_Begin" type="Node" parent="GameState"]
process_mode = 4
script = ExtResource("2_jjydy")

[node name="GoToGameAfter1" type="Node" parent="GameState/STATE_Begin"]
script = ExtResource("4_00bpe")
time = 0.5
target_state = "STATE_Game"

[node name="play_pyramid_open" type="Node" parent="GameState/STATE_Begin" node_paths=PackedStringArray("player")]
script = ExtResource("3_utl4f")
player = NodePath("../../../pyramid/AnimationPlayer")
animation_name = "Pyramid_Open"

[node name="STATE_Resume" type="Node" parent="GameState"]
process_mode = 4
script = ExtResource("2_jjydy")

[node name="GoToGameAfter1" type="Node" parent="GameState/STATE_Resume"]
script = ExtResource("4_00bpe")
time = 0.5
target_state = "STATE_Game"

[node name="play_pyramid_open" type="Node" parent="GameState/STATE_Resume" node_paths=PackedStringArray("player")]
script = ExtResource("3_utl4f")
player = NodePath("../../../pyramid/AnimationPlayer")
animation_name = "Pyramid_Open"

[node name="STATE_Game" type="Node" parent="GameState"]
process_mode = 4
script = ExtResource("2_jjydy")

[node name="pause" type="Node" parent="GameState/STATE_Game"]
script = ExtResource("7_m0nf8")
target_state = "STATE_Paused"
wait_for_frame = true

[node name="GoToReset" type="Node" parent="GameState/STATE_Game"]
script = ExtResource("3_cdlvk")
target_state = "STATE_Reset"

[node name="GoToEnd" type="Node" parent="GameState/STATE_Game"]
script = ExtResource("3_cdlvk")
target_state = "STATE_End"

[node name="TowerPlacementCursor" type="Node3D" parent="GameState/STATE_Game"]
unique_name_in_owner = true
script = ExtResource("5_ffcvi")

[node name="Indicators" type="Node3D" parent="GameState/STATE_Game/TowerPlacementCursor"]

[node name="Indicator_Valid" type="MeshInstance3D" parent="GameState/STATE_Game/TowerPlacementCursor/Indicators"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.4, 0)
material_override = ExtResource("7_nbnsr")
mesh = SubResource("BoxMesh_ad2qx")
skeleton = NodePath("../..")

[node name="Indicator_Invalid" type="MeshInstance3D" parent="GameState/STATE_Game/TowerPlacementCursor/Indicators"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.4, 0)
visible = false
material_override = ExtResource("7_813af")
mesh = SubResource("BoxMesh_ad2qx")
skeleton = NodePath("../..")

[node name="shop" type="Node3D" parent="GameState/STATE_Game"]

[node name="button_buy_spiketrap" parent="GameState/STATE_Game/shop" instance=ExtResource("19_iw33e")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -12.8256, 0.489027, 0)
script = ExtResource("19_d2pne")

[node name="Label3D" type="Label3D" parent="GameState/STATE_Game/shop/button_buy_spiketrap/Button_Square" index="1"]
transform = Transform3D(-1, 8.74228e-08, 3.82137e-15, 0, -8.9407e-08, 1, 8.74228e-08, 1, 8.9407e-08, 0.045249, 0.415932, 0.894457)
modulate = Color(0.835294, 0.478431, 0.372549, 1)
outline_modulate = Color(0.686275, 0.368627, 0.290196, 1)
text = "Spiketrap
"
font = ExtResource("18_odmy1")
font_size = 120
outline_size = 24

[node name="Label3D4" type="Label3D" parent="GameState/STATE_Game/shop/button_buy_spiketrap/Button_Square" index="2"]
transform = Transform3D(-1, 8.74228e-08, 3.82137e-15, 0, -8.9407e-08, 1, 8.74228e-08, 1, 8.9407e-08, 0.045249, 0.415932, -0.686682)
modulate = Color(0.835294, 0.478431, 0.372549, 1)
outline_modulate = Color(0.686275, 0.368627, 0.290196, 1)
text = "$100"
font = ExtResource("18_odmy1")
font_size = 150
outline_size = 24

[node name="select_spiketrap" type="Node" parent="GameState/STATE_Game/shop/button_buy_spiketrap"]
script = ExtResource("21_l56ot")
tower = ExtResource("23_a7ts0")

[node name="button_buy_crossbow" parent="GameState/STATE_Game/shop" instance=ExtResource("19_iw33e")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -12.8256, 0.489027, -3.54245)
script = ExtResource("19_d2pne")

[node name="Label3D2" type="Label3D" parent="GameState/STATE_Game/shop/button_buy_crossbow/Button_Square" index="1"]
transform = Transform3D(-1, 8.74228e-08, 3.82137e-15, 0, -8.9407e-08, 1, 8.74228e-08, 1, 8.9407e-08, 0.00495052, 0.41593, 0.764946)
modulate = Color(0.835294, 0.478431, 0.372549, 1)
outline_modulate = Color(0.686275, 0.368627, 0.290196, 1)
text = "Crossbow
"
font = ExtResource("18_odmy1")
font_size = 120
outline_size = 24

[node name="Label3D3" type="Label3D" parent="GameState/STATE_Game/shop/button_buy_crossbow/Button_Square" index="2"]
transform = Transform3D(-1, 8.74228e-08, 3.82137e-15, 0, -8.9407e-08, 1, 8.74228e-08, 1, 8.9407e-08, 0.00495052, 0.41593, -0.624978)
modulate = Color(0.835294, 0.478431, 0.372549, 1)
outline_modulate = Color(0.686275, 0.368627, 0.290196, 1)
text = "$200"
font = ExtResource("18_odmy1")
font_size = 150
outline_size = 24

[node name="select_crossbow" type="Node" parent="GameState/STATE_Game/shop/button_buy_crossbow"]
script = ExtResource("21_l56ot")
tower = ExtResource("24_njx8m")

[node name="stats" type="Node3D" parent="GameState/STATE_Game"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 12.8137, 0, 0)

[node name="button_buy_spiketrap2" parent="GameState/STATE_Game/stats" instance=ExtResource("19_iw33e")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.0639267, 0.489027, 0)

[node name="Label3D" type="Label3D" parent="GameState/STATE_Game/stats/button_buy_spiketrap2/Button_Square" index="1"]
transform = Transform3D(-1, 8.74228e-08, 3.82137e-15, 0, -8.9407e-08, 1, 8.74228e-08, 1, 8.9407e-08, 0.045249, 0.415932, 0.894457)
modulate = Color(0.906795, 0.38005, 0.567555, 1)
outline_modulate = Color(0.686275, 0.368627, 0.290196, 1)
text = "Health
"
font = ExtResource("18_odmy1")
font_size = 140
outline_size = 24

[node name="HealthTracker" type="Label3D" parent="GameState/STATE_Game/stats/button_buy_spiketrap2/Button_Square" index="2"]
transform = Transform3D(-1, 8.74228e-08, 3.82137e-15, 0, -8.9407e-08, 1, 8.74228e-08, 1, 8.9407e-08, 0.045249, 0.415932, 0.279041)
modulate = Color(0.837846, 0.760556, 0.786287, 1)
outline_modulate = Color(0.686275, 0.368627, 0.290196, 1)
text = "
999"
font = ExtResource("18_odmy1")
font_size = 250
outline_size = 24
script = ExtResource("17_qjf4m")

[node name="Button_Square2" type="MeshInstance3D" parent="GameState/STATE_Game/stats/button_buy_spiketrap2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -3.81834)
mesh = SubResource("ArrayMesh_blnw8")
skeleton = NodePath("")

[node name="StaticBody3D" type="StaticBody3D" parent="GameState/STATE_Game/stats/button_buy_spiketrap2/Button_Square2"]
collision_layer = 512

[node name="CollisionShape3D" type="CollisionShape3D" parent="GameState/STATE_Game/stats/button_buy_spiketrap2/Button_Square2/StaticBody3D"]
shape = SubResource("ConvexPolygonShape3D_k3uw6")

[node name="CollisionShape3D2" type="CollisionShape3D" parent="GameState/STATE_Game/stats/button_buy_spiketrap2/Button_Square2/StaticBody3D"]
shape = SubResource("ConvexPolygonShape3D_18mgh")

[node name="Label3D" type="Label3D" parent="GameState/STATE_Game/stats/button_buy_spiketrap2/Button_Square2"]
transform = Transform3D(-1, 8.74228e-08, 3.82137e-15, 0, -8.9407e-08, 1, 8.74228e-08, 1, 8.9407e-08, 0.045249, 0.415932, 0.894457)
modulate = Color(0.559196, 0.571713, 0.751938, 1)
outline_modulate = Color(0.686275, 0.368627, 0.290196, 1)
text = "Score
"
font = ExtResource("18_odmy1")
font_size = 140
outline_size = 24

[node name="ScoreTracker" type="Label3D" parent="GameState/STATE_Game/stats/button_buy_spiketrap2/Button_Square2"]
transform = Transform3D(-1, 8.74228e-08, 3.82137e-15, 0, -8.9407e-08, 1, 8.74228e-08, 1, 8.9407e-08, 0.045249, 0.415932, 0.279041)
modulate = Color(0.837846, 0.760556, 0.786287, 1)
outline_modulate = Color(0.686275, 0.368627, 0.290196, 1)
text = "
9999"
font = ExtResource("18_odmy1")
font_size = 200
outline_size = 24
script = ExtResource("19_dibw2")

[node name="STATE_End" type="Node" parent="GameState"]
process_mode = 4
script = ExtResource("2_jjydy")

[node name="play_pyramid_close" type="Node" parent="GameState/STATE_End" node_paths=PackedStringArray("player")]
script = ExtResource("3_utl4f")
player = NodePath("../../../pyramid/AnimationPlayer")
animation_name = "Pyramid_Open"
reverse = true

[node name="STATE_Paused" type="Node" parent="GameState"]
process_mode = 4
script = ExtResource("2_jjydy")

[node name="MenuVisibility" type="Node" parent="GameState/STATE_Paused"]
script = ExtResource("3_flvjl")

[node name="play_pyramid_close" type="Node" parent="GameState/STATE_Paused" node_paths=PackedStringArray("player")]
script = ExtResource("3_utl4f")
player = NodePath("../../../pyramid/AnimationPlayer")
animation_name = "Pyramid_Open"
reverse = true

[node name="resume" type="Node" parent="GameState/STATE_Paused"]
script = ExtResource("7_m0nf8")
resume = true
target_state = "STATE_Resume"

[node name="GoToExit" type="Node" parent="GameState/STATE_Paused"]
script = ExtResource("3_cdlvk")
target_state = "STATE_Exiting"
wait_for_frame = true

[node name="STATE_Reset" type="Node" parent="GameState"]
process_mode = 4
script = ExtResource("2_jjydy")

[node name="GoToBeginAfter1" type="Node" parent="GameState/STATE_Reset"]
script = ExtResource("4_00bpe")
time = 1.0
target_state = "STATE_Begin"

[node name="play_pyramid_close" type="Node" parent="GameState/STATE_Reset" node_paths=PackedStringArray("player")]
script = ExtResource("3_utl4f")
player = NodePath("../../../pyramid/AnimationPlayer")
animation_name = "Pyramid_Open"
reverse = true

[node name="STATE_None" type="Node" parent="GameState"]
process_mode = 4
script = ExtResource("2_jjydy")

[node name="STATE_Exiting" type="Node" parent="GameState"]
process_mode = 4
script = ExtResource("2_jjydy")

[node name="Exit" type="Node" parent="GameState/STATE_Exiting"]
script = ExtResource("6_1nd5i")

[node name="Map" parent="." instance=ExtResource("2_2bc4d")]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -10, -0.5, -10)

[node name="Spawner" parent="Map/Maze/MazePath" index="0" instance=ExtResource("8_ips6i")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1, 0)
enemyTypes = {
"enemy_1": ExtResource("9_jyc2j"),
"enemy_2": ExtResource("10_bt8ur"),
"enemy_croc": ExtResource("11_o3g5j"),
"enemy_indy": ExtResource("11_g30fw"),
"enemy_roman": ExtResource("13_yqiol")
}

[node name="MazeMesher" parent="Map/Maze" index="1"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.101383, -0.0325584, 0.0300293)

[node name="Camera3D" type="Camera3D" parent="."]
transform = Transform3D(-1, 8.21505e-08, -2.99004e-08, 0, 0.34202, 0.939693, 8.74228e-08, 0.939693, -0.34202, 0, 14.226, -7.652)

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_0i1up")

[node name="MenuViewport" type="SubViewport" parent="WorldEnvironment"]

[node name="Control" type="Control" parent="."]
layout_mode = 3
anchors_preset = 0
offset_right = 40.0
offset_bottom = 40.0

[node name="VBoxContainer" type="VBoxContainer" parent="Control"]
layout_mode = 0
offset_right = 212.0
offset_bottom = 40.0

[node name="New Path Button" type="Button" parent="Control/VBoxContainer"]
layout_mode = 2
text = "Give me a new path
"

[node name="Place Tower button" type="Button" parent="Control/VBoxContainer"]
layout_mode = 2
text = "Place a tower"

[node name="Begin Round button" type="Button" parent="Control/VBoxContainer"]
layout_mode = 2
text = "Begin Round"

[node name="Tower Placing Indicator" type="RichTextLabel" parent="Control/VBoxContainer"]
visible = false
layout_mode = 2
bbcode_enabled = true
text = "[center]Tower Placement Active!"
fit_content = true

[node name="pyramid" parent="." instance=ExtResource("13_tao2x")]

[node name="North_Anchor" parent="pyramid/Pyramid_Armature/Skeleton3D" index="0"]
transform = Transform3D(0.288751, 0, 0, 0, 0.288751, 0, 0, 0, 0.288751, 0, 0, -10.2578)

[node name="AnimationPlayer" parent="pyramid" index="3"]
process_mode = 3

[connection signal="enabling" from="GameState/STATE_Menu" to="GameState/STATE_Menu/MenuVisibility" method="do_signal"]
[connection signal="relay" from="GameState/STATE_Menu/MenuVisibility" to="pyramid/Pyramid_Armature/Skeleton3D/North_Anchor/startmenu" method="show"]
[connection signal="relay" from="GameState/STATE_Menu/MenuVisibility" to="pyramid/Pyramid_Armature/Skeleton3D/North_Anchor/escmenu" method="hide"]
[connection signal="relay" from="GameState/STATE_Menu/MenuVisibility" to="pyramid/Pyramid_Armature/Skeleton3D/North_Anchor/gameovermenu" method="hide"]
[connection signal="enabling" from="GameState/STATE_Begin" to="GameState/STATE_Begin/play_pyramid_open" method="play"]
[connection signal="enabling" from="GameState/STATE_Begin" to="Map/Maze" method="create_new_maze"]
[connection signal="enabling" from="GameState/STATE_Resume" to="GameState/STATE_Resume/play_pyramid_open" method="play"]
[connection signal="placing_started" from="GameState/STATE_Game/TowerPlacementCursor" to="GameState/STATE_Game/TowerPlacementCursor/Indicators" method="show"]
[connection signal="placing_started" from="GameState/STATE_Game/TowerPlacementCursor" to="Control/VBoxContainer/Tower Placing Indicator" method="show"]
[connection signal="tower_placed" from="GameState/STATE_Game/TowerPlacementCursor" to="GameState/STATE_Game/TowerPlacementCursor/Indicators" method="hide"]
[connection signal="tower_placed" from="GameState/STATE_Game/TowerPlacementCursor" to="Control/VBoxContainer/Tower Placing Indicator" method="hide"]
[connection signal="pressed" from="GameState/STATE_Game/shop/button_buy_spiketrap" to="GameState/STATE_Game/shop/button_buy_spiketrap/select_spiketrap" method="select"]
[connection signal="selected" from="GameState/STATE_Game/shop/button_buy_spiketrap/select_spiketrap" to="GameState/STATE_Game/TowerPlacementCursor" method="start_placing"]
[connection signal="pressed" from="GameState/STATE_Game/shop/button_buy_crossbow" to="GameState/STATE_Game/shop/button_buy_crossbow/select_crossbow" method="select"]
[connection signal="selected" from="GameState/STATE_Game/shop/button_buy_crossbow/select_crossbow" to="GameState/STATE_Game/TowerPlacementCursor" method="start_placing"]
[connection signal="enabling" from="GameState/STATE_End" to="GameState/STATE_End/play_pyramid_close" method="play"]
[connection signal="enabling" from="GameState/STATE_Paused" to="GameState/STATE_End/play_pyramid_close" method="play"]
[connection signal="enabling" from="GameState/STATE_Paused" to="GameState/STATE_Paused/MenuVisibility" method="do_signal"]
[connection signal="relay" from="GameState/STATE_Paused/MenuVisibility" to="pyramid/Pyramid_Armature/Skeleton3D/North_Anchor/startmenu" method="hide"]
[connection signal="relay" from="GameState/STATE_Paused/MenuVisibility" to="pyramid/Pyramid_Armature/Skeleton3D/North_Anchor/escmenu" method="show"]
[connection signal="relay" from="GameState/STATE_Paused/MenuVisibility" to="pyramid/Pyramid_Armature/Skeleton3D/North_Anchor/gameovermenu" method="hide"]
[connection signal="enabling" from="GameState/STATE_Reset" to="GameState/STATE_Reset/play_pyramid_close" method="play"]
[connection signal="enabling" from="GameState/STATE_Exiting" to="GameState/STATE_Exiting/Exit" method="exit"]
[connection signal="pressed" from="Control/VBoxContainer/New Path Button" to="GameState/STATE_Game/GoToReset" method="go_to_state"]
[connection signal="pressed" from="Control/VBoxContainer/Place Tower button" to="GameState/STATE_Game/TowerPlacementCursor" method="start_placing"]
[connection signal="pressed" from="Control/VBoxContainer/Begin Round button" to="Map/Maze/MazePath/Spawner" method="_start_round"]
[connection signal="pressed" from="pyramid/Pyramid_Armature/Skeleton3D/North_Anchor/startmenu/button_start" to="GameState/STATE_Menu/GoToBegin" method="go_to_state"]
[connection signal="pressed" from="pyramid/Pyramid_Armature/Skeleton3D/North_Anchor/startmenu/button_exit" to="GameState/STATE_Menu/GoToExit" method="go_to_state"]
[connection signal="pressed" from="pyramid/Pyramid_Armature/Skeleton3D/North_Anchor/escmenu/button_resume" to="GameState/STATE_Paused/resume" method="pause_resume"]
[connection signal="pressed" from="pyramid/Pyramid_Armature/Skeleton3D/North_Anchor/escmenu/button_exit" to="GameState/STATE_Paused/GoToExit" method="go_to_state"]

[editable path="GameState/STATE_Game/shop/button_buy_spiketrap"]
[editable path="GameState/STATE_Game/shop/button_buy_crossbow"]
[editable path="GameState/STATE_Game/stats/button_buy_spiketrap2"]
[editable path="Map"]
[editable path="pyramid"]
[editable path="pyramid/Pyramid_Armature/Skeleton3D/North_Anchor/startmenu/button_start"]
[editable path="pyramid/Pyramid_Armature/Skeleton3D/North_Anchor/startmenu/button_exit"]
[editable path="pyramid/Pyramid_Armature/Skeleton3D/North_Anchor/escmenu/button_resume"]
[editable path="pyramid/Pyramid_Armature/Skeleton3D/North_Anchor/escmenu/button_exit"]
[editable path="pyramid/Pyramid_Armature/Skeleton3D/North_Anchor/gameovermenu/button_restart"]
[editable path="pyramid/Pyramid_Armature/Skeleton3D/North_Anchor/gameovermenu/button_exit"]
